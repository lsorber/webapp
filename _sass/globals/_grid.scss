/* Mobile-first flexbox-based grid.

   This grid has two modes: mobile and desktop. The mobile mode is the default,
   and it switches to desktop starting at a tablet resolution.

   Grid gutter width `gutter-mobile-[int]` is the space left and right of the
   grid on both mobile and desktop as an integer multiple of 1vw, where 1vw is
   1% of the viewport width. May be overruled by `gutter-desktop-[int]` on
   desktop.

   Cell spacing `colspacing-mobile-[int]` is the vertical space between cells
   in a grid on mobile, also an integer multiple of 1vw. May be overruled by
   `colspacing-desktop-[int]` on desktop, were it applies to the horizontal
   space between cells.

   Row spacing `rowspacing-mobile-[int]` is the vertical space between cells in
   a grid on mobile, also an integer multiple of 1vw. May be overruled by
   `rowspacing-desktop-[int]` on desktop.

   Example HTML:
        <div class="grid gutter-mobile-3 gutter-desktop-12 rowspacing-mobile-6
            rowspacing-desktop-3 colspacing-mobile-3 colspacing-desktop-3">
            <div class="row">
                <div class="col width-6-of-12">A</div>
                <div class="col width-auto">B</div>
                <div class="col width-auto">C</div>
            </div>
            <div class="row">
                <div class="col width-auto">A</div>
                <div class="col width-8-of-12">B</div>
                <div class="col width-auto">C</div>
            </div>
        </div>
*/

/* Default grid configuration. */

$grid-spacing-unit: 1vw !default;
$grid-spacing-max-steps: 32 !default;
$grid-colwidth-max-steps: 12 !default;

/* Mobile grid. */

@for $i from 1 through $grid-spacing-max-steps {
    /* The vertical margin between columns on mobile. */
    .grid.colspacing-mobile-#{$i} > .row > .col:not(:first-child) {
        margin-top: $i * $grid-spacing-unit;
    }
    /* The vertical margin between rows on mobile. */
    .grid.rowspacing-mobile-#{$i} > .row:not(:first-child) {
        margin-top: $i * $grid-spacing-unit;
    }
    /* The horizontal space between the grid and its parent. Implemented as
       padding so that row backgrounds can span the full width of the grid. */
    .grid.gutter-mobile-#{$i} > .row {
        padding-left: $i * $grid-spacing-unit;
        padding-right: $i * $grid-spacing-unit;
    }
}

/* Desktop grid. */

@media #{$tablet-and-up} {
    /* Switch to rendering the row as a flex container. */
    .row {
        @include display-flex;
    }
    /* Utility class to vertically center columns instead of the default
       behaviour of stretching them to fill the row. */
    .row.align-items-center {
        align-items: center;
    }
    /* Column width classes. */
    .col.width-auto {
        @include flex($flex-grow: 1);
    }
    @for $i from 1 through $grid-colwidth-max-steps {
        .col.width-#{$i}-of-#{$grid-colwidth-max-steps} {
            width: $i / $grid-colwidth-max-steps * 100%;
        }
    }
    /* Column, row and grid spacing classes. */
    @for $i from 1 through $grid-spacing-max-steps {
        .grid.colspacing-mobile-#{$i} > .row > .col:not(:first-child) {
            margin-top: 0;
            margin-left: $i * $grid-spacing-unit;
        }
        .grid.colspacing-desktop-#{$i} > .row > .col:not(:first-child) {
            margin-left: $i * $grid-spacing-unit;
        }
        .grid.rowspacing-desktop-#{$i} > .row:not(:first-child) {
            margin-top: $i * $grid-spacing-unit;
        }
        .grid.gutter-desktop-#{$i} > .row {
            padding-left: $i * $grid-spacing-unit;
            padding-right: $i * $grid-spacing-unit;
        }
    }
}
